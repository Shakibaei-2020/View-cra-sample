<app-administrateur></app-administrateur>



<div class="div-edit">

  <div class="container">
    <div class="panel">

      <div>
        <button class="img-fluid bouttonSousMenu">
          <i class="fas fa-users"></i>

        </button>
        <h2 class="page">Modification du collaborateur : {{collaborateur.firstName}} {{collaborateur.lastName}} </h2>
      </div>
      <hr>
      <div class="panel-body bio-graph-info">
        <div class="row">
          <div class="bio-row">
            
            <div class="inputbox mt-1">

              <span class="input-title">Prénom :  </span>
            <input type="text" value="{{collaborateur.firstName}}" name="firstNameCollab" id="firstNameCollab">
          </div>

               
          <div class="inputbox mt-1">
            <span class="input-title">Adresse mail : </span>
             <input type="text" value="{{collaborateur.email}}"  name="emailCollab" id="emailCollab"> </div>


            <div class="inputbox mt-1">
              <span class="input-title">Date d'entrée :</span>
               <input type="date" name="dateEntryCollab"  value="{{collaborateur.oldDateOfEntry}}" id="dateEntryCollab"> </div>
           
           
          </div>

          <div class="bio-row">
            <div class="inputbox mt-1">
              <span class="input-title">Nom de famille :</span>
              <input type="text" value="{{collaborateur.lastName}}" name="lastNameCollab" id="lastNameCollab"> </div>
           
              <div class="inputbox mt-3">
                <span>Type :</span><br>
                <select class="typeCollab" aria-label="Default select example" name="typeCollab" id="typeCollab">
                  <option hidden value="" disabled selected>{{typeCollaborator.type}} </option>
                  <option *ngFor="let allTypeCollaborators of allTypeCollaborator" value="{{allTypeCollaborators.id}}">{{allTypeCollaborators.type}}
                </select>
              </div>

              <div class="inputbox mt-1">
                <span class="input-title">Date de sortie : </span>
              <input type="date" name="dateOutCollab"  value="{{collaborateur.oldDateOfRelease}}" id="dateOutCollab"> </div>

         
         
            
              <div class="row">
                <div class="col-sm-4">
                  <button class="btnAction gb2 gb-bordered hover-slide" id="gb79"  (click)="goToSearch()">Retour</button>

                </div>
                <div class="col-sm-4">
                  <button class="btnAction gb2 gb-bordered hover-slide"  id="gb79"  data-toggle="modal" data-target="#updateModal">Mettre à jour</button>

                </div>
                <div class="col-sm-4">
                  <button class="btnAction gb2 gb-bordered hover-slide" id="gb79"  data-toggle="modal" data-target="#DeleteModal">Supprimer</button>

                </div>
            </div>

          </div>


          <div class="bio-row">

            <div class="modal fade" id="updateModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Alert update</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    Êtes vous sur de vouloir mettre à jour ?
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btnViolet" data-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btnViolet" (click)="updateCollab()">Sauvgarder</button>
                  </div>
                </div>
              </div>
            </div>

            
            <div class="modal fade" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
              aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Alert delete</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    Êtes vous sur de vouloir supprimer?
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btnViolet" data-dismiss="modal">Annuler</button>
                    <button type="button" class="btn btnViolet" (click)="deleteCollab()">Supprimer</button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>


<!-- gestion des notes de frais-->
    <div class="">
      <p class=" gb2 gb-bordered" id="gb79" > Notes de frais : En-cours </p>
    </div>
    <br>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Date de la demande</th>
          <th>Date de frais</th>
          <th>Coût HT</th>
          <th>Coût TVA</th>
          <th>Coût TTC</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let expense of expenses; let indexOfelement = index;">
          <td>
            <span class="">{{expense.dateRequest | date: 'dd/MM/yyyy'}}</span>
          </td>
          <td>
            <span class="">{{expense.dateExpense | date: 'dd/MM/yyyy'}}</span>
          </td>
          <td>
            <span class=""> {{expense.costHT}} €</span>
          </td>
          <td>
            <span class=""> {{expense.costTVA}} €</span>
          </td>
          <td>
            <span class=""> {{expense.costTTC}} €</span>
          </td>
       
          <td>
            <button type="button" class="btnEditer gb2 gb-bordered hover-slide" id="gb79" (click)="updateTTC(indexOfelement)"  data-toggle="modal" [attr.data-target]=" '#myExpenseModal-' + indexOfelement">Éditer</button>
          </td>
        </tr>
      </tbody>
    </table>







    <!-- Modal -->
    <div *ngFor="let expense of expenses; let indexOfelement =index;">

      <div class="modal fade" id="myExpenseModal-{{indexOfelement}}" role="dialog">
        <div class="modal-dialog modal-xl modal-dialog-centered" >
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <h3>Gestion de la demande de frais du  {{expense.dateRequest  | date: 'dd/MM/yyyy'}}</h3>
              <div class="expenseRequestId">
                 <input type="text" value="{{expense.id}}" name="expenseRequestId-{{indexOfelement}}" id="expenseRequestId-{{indexOfelement}}" disabled> 
              </div>
            </div>
            <div class="modal-body">
              <div class="row">

                <!-- Colonne 1-->
                <div class="col-sm-6">

                  <div class="inputbox mt-1">
                    <span> Cout HT :</span><br>
                    <input class="modal-input" type="number"  value="{{expense.costHT}}" name="expenseCostHT-{{indexOfelement}}" id="expenseCostHT-{{indexOfelement}}" (input)="updateTTC(indexOfelement)">
                  </div>

                  <div class="inputbox mt-1">
                    <span> Cout TTC :</span><br>
                    <input class="modal-input" type="number"  name="newCostTTC-{{indexOfelement}}" id="newCostTTC-{{indexOfelement}}"  placeholder="{{TTCvalue}}" disabled>
                  </div>
                 

                  <div class="inputbox mt-1">
                    <span> Facturable : </span><br>
                    <select class="modal-input"  name="expenseBillable-{{indexOfelement}}" id="expenseBillable-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{expense.billableFR}} </option>
                      <option value="true">oui</option>
                      <option value="false">non</option>
                    </select>
                  </div>

            

                  <div class="inputbox mt-1">
                    <span> Date de frais :</span><br>
                    <input class="modal-input" type="date"  value="{{expense.oldDateExpense}}"    name="dateExpense-{{indexOfelement}}" id="dateExpense-{{indexOfelement}}">
                  </div>

                </div>

                <!-- Colonne 2-->
                <div class="col-sm-6">

                  <div class="inputbox mt-1">
                    <span> Cout TVA : </span><br>
                    <input class="modal-input" type="text"  value="{{expense.costTVA}}" name="expenseCostTVA-{{indexOfelement}}" id="expenseCostTVA-{{indexOfelement}}" (input)="updateTTC(indexOfelement)">
                  </div>

                  <div class="inputbox mt-1 expenseRequestId" >
                    <span> Date demande :</span><br>
                    <input class="modal-input" type="date"   name="dateExpenseRequest-{{indexOfelement}}" id="dateExpenseRequest-{{indexOfelement}}" disabled>
                  </div>

                  <div class="inputbox mt-1">
                    <span> Type : </span><br>
                    <select class="modal-input"  name="expenseType-{{indexOfelement}}" id="expenseType-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{expense.typeExpense.type}} </option>
                      <option *ngFor="let allExpenseTypes of allExpenseType" value="{{allExpenseTypes.id}}">{{allExpenseTypes.type}}
                    </select>
                  </div>




                  <div class="inputbox mt-1">
                    <span> État de la demande : </span><br>
                    <select class="modal-input" name="expenseStatus-{{indexOfelement}}" id="expenseStatus-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{expense.status}} </option>
                      <option *ngFor="let statue of status" value={{statue}}>{{statue}}</option>
                    </select>
                  </div>

                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btnViolet" type="submit" (click)="updateExpense(indexOfelement)">Maj</button>
                <button class="btn btnViolet" type="submit" (click)="deleteExpenseById(expense.id)">Supprimer</button>
              </div>

              


                


            </div>
          </div>
        </div>
      </div>
    </div>







    <br>
    <!--  DEMANDE DE CONGE -->
    <div class="">
      <p class=" gb2 gb-bordered" id="gb79" > Demandes de congées : En-cours </p>
    </div>
    <br>
    <table class="table table-striped table-bordered">
      <thead>
        <tr>
          <th>Date de la demande</th>
          <th>Date de début</th>
          <th>Date de retour</th>
          <th>Type</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let leave of leaves; let indexOfelement =index;">
          <td>
            <span class="">{{leave.dateOfDemand | date: 'dd/MM/yyyy'}}</span>
          </td>
          <td>
            <span class="">{{leave.dateOfStartLeave | date: 'dd/MM/yyyy'}}</span>
          </td>
          <td>
            <span class="">{{leave.dateOfEndLeave | date: 'dd/MM/yyyy'}}</span>
          </td>
          <td>
            <span class=""> {{leave.leaveType.type}}</span>
          </td>
          <td>
            <button class="btnEditer gb2 gb-bordered hover-slide" id="gb79" data-toggle="modal" [attr.data-target]=" '#myLeaveModal-' + indexOfelement">Éditer</button>
          </td>
        </tr>
      </tbody>
    </table>
    <br>
    <br>
    <br>
    <br>

    <!-- Modal -->
    <div *ngFor="let leave of leaves; let indexOfelement =index;">
      <div class="modal fade" id="myLeaveModal-{{indexOfelement}}" role="dialog">
        <div class="modal-dialog modal-xl modal-dialog-centered" >
          <!-- Modal content-->
          <div class="modal-content">
            <div class="modal-header">
              <h3>Gestion de la demande de congé du  {{leave.dateOfDemand | date: 'dd/MM/yyyy'}}</h3>
              <div class="expenseRequestId">
                <input type="text" value="{{leave.id}}" name="leaveRequestId-{{indexOfelement}}"  id="leaveRequestId-{{indexOfelement}}" disabled>
              </div>
            </div>
            <div class="modal-body">
              <div class="row">
                <!-- Colonne 1-->
                <div class="col-sm-6">
              
                  <div class="inputbox mt-3">
                    <div>
                      <label><input type="checkbox" name="joursEntiers-{{indexOfelement}}" id="joursEntiers-{{indexOfelement}}" (change)="joursEntiersChecked(indexOfelement)"> jours entiers</label>
                    </div>
                  </div>
                  
                  <div class="inputbox mt-1">
                    <span> Date de départ : </span><br>
                    <input class="modal-input" type="date" value="{{leave.oldDateOfStartLeave}}"  name="dateStartLeave-{{indexOfelement}}" id="dateStartLeave-{{indexOfelement}}" (change)="howManyday(indexOfelement)">
                  </div>
                  
                  <div class="inputbox mt-1">
                    <span> Date de retour : </span><br>
                    <input class="modal-input" type="date" value="{{leave.oldDateOfEndLeave}}" name="dateEndLeave-{{indexOfelement}}" id="dateEndLeave-{{indexOfelement}}" (change)="howManyday(indexOfelement)">
                  </div>

                  <div class="inputbox mt-1">
                    <span> Type de congé : </span><br>
                    <select class="modal-input" name="leaveType-{{indexOfelement}}" id="leaveType-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{leave.leaveType.type}} </option>
                      <option *ngFor="let typeConge of allLeaveType" value="{{typeConge.id}}">{{typeConge.type}}
                      </option>
                    </select>
                  </div>

                  <div class="inputbox mt-1">
                    <span> État de la demande : </span><br>
                    <select class="modal-input" name="leaveStatus-{{indexOfelement}}" id="leaveStatus-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{leave.status}} </option>
                      <option *ngFor="let statue of status" value={{statue}}>{{statue}}</option>
                    </select>
                  </div>
                </div>

                <!-- Colonne 2-->
                <div class="col-sm-6">

                  <div class="inputbox mt-1 expenseRequestId">
                    <span> Date de demande : {{leave.dateOfDemand | date: 'dd/MM/yyyy'}}</span><br>
                    <input class="modal-input" type="date" name="dateLeaveRequest-{{indexOfelement}}" id="dateLeaveRequest-{{indexOfelement}}" disabled>
                  </div>

                  <div class="rightInputs"> 
                  <div class="inputbox mt-1">
                    <span> Début : </span><br>
                    <select class="modal-input" name="leaveStatusDebut-{{indexOfelement}}" id="leaveStatusDebut-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{leave.statusDebut}} </option>

                      <option value="matin">Matinée</option>
                      <option value="après-midi">Après-midi</option>
                      <option value="journée entière">Journée entière</option>
                    </select>
                  </div>
               
                  <div class="inputbox mt-1">
                    <span> Fin : </span><br>
                    <select class="modal-input" name="leaveStatusFin-{{indexOfelement}}" id="leaveStatusFin-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{leave.statusFin}} </option>
                      <option value="matin">Matinée</option>
                      <option value="après-midi">Après-midi</option>
                      <option value="journée entière">Journée entière</option>
                    </select>
                  </div>

                  <div class="inputbox mt-1">
                    <span> Client informé : </span><br>
                    <select class="modal-input" name="leaveClientInformed-{{indexOfelement}}" id="leaveClientInformed-{{indexOfelement}}">
                      <option hidden value="" disabled selected>{{leave.clientInformedFR}} </option>
                      <option value="true">Oui</option>
                      <option value="false">Non</option>
                    </select>
                  </div>

                  <div class="inputbox mt-3">
                    <span>Total jours :  </span>
                    <input type="text" value="{{dayNumber}}" placeholder="{{leave.nbJours}} " disabled>
                  </div>

                </div>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btnViolet" type="submit" (click)="updateLeaveFromCollab(indexOfelement)">Maj</button>
                <button class="btn btnViolet" type="submit" (click)="deleteLeaveFromCollab(leave.id)">Supprimer</button>
              </div>












              
            </div>
          </div>
        </div>
      </div>
    </div>


  </div>
</div>
