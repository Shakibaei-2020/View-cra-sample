<app-administrateur></app-administrateur>

<br><br><br>


<div class="container">
  <div class="panel">
    <div>
      <button class="img-fluid bouttonMenu">
        <i class="fas fa-bullseye"></i>

      </button>
      <h2>Ajouter nouvelle mission</h2>
    </div>
    <hr>




    <div class="panel-body bio-graph-info">

      <br>
      <div class="row">

        <div class="bio-row">

          <div class="inputbox mt-1">
            <span class="input-title">Nom du client : </span><br>
            <select class="form-input" aria-label="Default select example" required [(ngModel)]="idClientByName"
              name="idClientByName" (change)="updateClientRef()">
              <option *ngFor="let client of clients" value="{{client.id}}">{{client.name}}</option>
            </select>
          </div>

          <div class="inputbox mt-1">
            <span class="input-title">Date de début :</span>
            <input type="Date" required [(ngModel)]="startDate" name="startDate">
          </div>

          <div class="inputbox mt-1">
            <span class="input-title">Nom de la mission :</span>
            <input type="text" autocomplete="off" required [(ngModel)]="newMission.missionTitle"
              name="newMission.missionTitle">
          </div>



        </div>

        <div class="bio-row">

          <div class="inputbox mt-1">
            <span class="input-title">Réf. client :</span><br>
            <select class="form-input" aria-label="Default select example" required [(ngModel)]="idClientByRef"
              name="idClientByRef" (change)="updateClientName()">
              <option *ngFor="let client of clients" value="{{client.id}}">{{client.ref}}</option>
            </select>
          </div>


          <div class="inputbox mt-1">
            <span class="input-title">Date de fin :</span>
            <input type="Date" required [(ngModel)]="endDate" name="endDate">
          </div>


          <div class="inputbox mt-1">
            <!-- <button type="button" class="btnTab" data-toggle="modal" [attr.data-target]=" '#myMissionModal'">Assigne project</button>-->

            <div class="projectTable">
              <table class="table">

                <tbody>
                  <div *ngFor="let field of fieldArray; let indexOfElement = index">
                    <input class="input-modal" [(ngModel)]="field.code" autocomplete="off" name="{{field.code}}"
                      id="projectName-{{indexOfElement}}" disabled />
                    <button class="btn btn-dark btn-block buttonModal" type="button"
                      (click)="deleteFieldValue(indexOfElement)">-</button>
                  </div>


                  <div>
                    <input class="input-modal" placeholder="Ajouter un projet" autocomplete="off" id="newAttributeCode"
                      [(ngModel)]="newAttribute.code" name="newAttributeCode" />
                    <button class="btn btn-dark btn-block buttonModal" type="button"
                      (click)="addFieldValue()">+</button>
                  </div>

                </tbody>
              </table>

            </div>

            <br>
            <div class="row">
              <div class="col-sm-6">
                <button class="btnTet gb-bordered hover-slide" id="gb79"  (click)="goToSearch()">Retour</button>

              </div>
              <div class="col-sm-6">
                <button class="btnTet gb-bordered hover-slide" id="gb79" data-toggle="modal" data-target="#DeleteModal">Ajouter</button>

              </div>
            </div>


          </div>
        </div>

      </div>


      <div class="modal fade" id="myMissionModal" role="dialog">
        <div class="modal-dialog modal-xl">
          <div class="modal-content">
            <div class="modal-header">
              <h3>Projets à attribuer:</h3>
              <div class="toHide">
              </div>
            </div>
            <div class="modal-body">

              <div class="modal-footer">
                <button class="btnModal" type="submit">Maj</button>
                <button class="btnModal" type="submit">Supprimer</button>
              </div>
            </div>
          </div>
        </div>
      </div>


      <div class="bio-row">
        <br>
          <span class="validation">{{validation}}</span>
          <span class="notValidation"> {{notValidation}}</span>

      </div>
          

      <div class="bio-row">







        <div class="modal fade" id="DeleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
          aria-hidden="true">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Ajout de mission</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                Êtes vous sur de vouloir ajouter cet mission?
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btnViolet" data-dismiss="modal">Annuler</button>
                <button type="button" class="btn btnViolet" data-dismiss="modal" (click)="addMission()">Ajouter</button>
              </div>
            </div>
          </div>
        </div>




      </div>
    </div>
  </div>